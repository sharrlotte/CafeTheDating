{
  "version": 3,
  "sources": ["../../../../src/middlewares/star.middlewares.ts"],
  "sourcesContent": ["import { checkSchema } from 'express-validator'\r\nimport { StatusCodes } from 'http-status-codes'\r\nimport { ObjectId } from 'mongodb'\r\nimport { VALIDATION_MESSAGES } from '@/constants/message'\r\nimport { ErrorWithStatus } from '@/models/errors/Errors.schema'\r\nimport { databaseService } from '@/services/database.service'\r\nimport validate from '@/utils/validate'\r\n\r\nexport const createStarValidator = validate(\r\n  checkSchema(\r\n    {\r\n      productId: {\r\n        trim: true,\r\n        custom: {\r\n          options: async (value, { req }) => {\r\n            if (!ObjectId.isValid(value)) {\r\n              throw new ErrorWithStatus({\r\n                message: VALIDATION_MESSAGES.USER.COMMONS.USER_ID_IS_INVALID,\r\n                statusCode: StatusCodes.NOT_FOUND\r\n              })\r\n            }\r\n\r\n            const result = await databaseService.stars.findOne({\r\n              user_id: req.user._id,\r\n              product_id: value\r\n            })\r\n\r\n            if (Boolean(result)) {\r\n              throw new ErrorWithStatus({\r\n                message: 'You already start this product',\r\n                statusCode: StatusCodes.BAD_REQUEST\r\n              })\r\n            }\r\n\r\n            return true\r\n          }\r\n        }\r\n      }\r\n    },\r\n    ['body']\r\n  )\r\n)\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAA4B;AAC5B,+BAA4B;AAC5B,qBAAyB;AACzB,qBAAoC;AACpC,oBAAgC;AAChC,sBAAgC;AAChC,sBAAqB;AAEd,MAAM,0BAAsB,gBAAAA;AAAA,MACjC;AAAA,IACE;AAAA,MACE,WAAW;AAAA,QACT,MAAM;AAAA,QACN,QAAQ;AAAA,UACN,SAAS,OAAO,OAAO,EAAE,IAAI,MAAM;AACjC,gBAAI,CAAC,wBAAS,QAAQ,KAAK,GAAG;AAC5B,oBAAM,IAAI,8BAAgB;AAAA,gBACxB,SAAS,mCAAoB,KAAK,QAAQ;AAAA,gBAC1C,YAAY,qCAAY;AAAA,cAC1B,CAAC;AAAA,YACH;AAEA,kBAAM,SAAS,MAAM,gCAAgB,MAAM,QAAQ;AAAA,cACjD,SAAS,IAAI,KAAK;AAAA,cAClB,YAAY;AAAA,YACd,CAAC;AAED,gBAAI,QAAQ,MAAM,GAAG;AACnB,oBAAM,IAAI,8BAAgB;AAAA,gBACxB,SAAS;AAAA,gBACT,YAAY,qCAAY;AAAA,cAC1B,CAAC;AAAA,YACH;AAEA,mBAAO;AAAA,UACT;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,IACA,CAAC,MAAM;AAAA,EACT;AACF;",
  "names": ["validate"]
}
