{
  "version": 3,
  "sources": ["../../../../src/middlewares/uploadFile.middleware.ts"],
  "sourcesContent": ["import { NextFunction, Request, Response } from 'express'\r\nimport { StatusCodes } from 'http-status-codes'\r\nimport multer from 'multer'\r\nimport path from 'path'\r\nimport { VALIDATION_MESSAGES } from '@/constants/message'\r\nimport { ErrorWithStatus } from '@/models/errors/Errors.schema'\r\n\r\nconst uploadFile = multer({\r\n  limits: {\r\n    fieldSize: 50 * 1024 * 1024\r\n  },\r\n  fileFilter: (req, file, callback) => {\r\n    const filetypes = /jpeg|jpg|png|gif/\r\n    const extname = filetypes.test(path.extname(file.originalname).toLowerCase())\r\n    const mimetype = filetypes.test(file.mimetype)\r\n\r\n    if (extname && mimetype) {\r\n      return callback(null, true)\r\n    }\r\n\r\n    callback(new Error('Error'))\r\n  }\r\n})\r\n\r\nexport const singleImageUpload = (name: string) => {\r\n  return (req: Request, res: Response, next: NextFunction) => {\r\n    uploadFile.single(name)(req, res, (err) => {\r\n      if (err instanceof multer.MulterError) {\r\n        next(\r\n          new ErrorWithStatus({\r\n            statusCode: StatusCodes.BAD_REQUEST,\r\n            message: VALIDATION_MESSAGES.UPLOAD.IMAGE.INVALID_IMAGE_SIZE\r\n          })\r\n        )\r\n      }\r\n\r\n      if (err instanceof Error) {\r\n        next(\r\n          new ErrorWithStatus({\r\n            statusCode: StatusCodes.BAD_REQUEST,\r\n            message: VALIDATION_MESSAGES.UPLOAD.IMAGE.INVALID_IMAGE_EXTENSION\r\n          })\r\n        )\r\n      }\r\n\r\n      next()\r\n    })\r\n  }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,+BAA4B;AAC5B,oBAAmB;AACnB,kBAAiB;AACjB,qBAAoC;AACpC,oBAAgC;AAEhC,MAAM,iBAAa,cAAAA,SAAO;AAAA,EACxB,QAAQ;AAAA,IACN,WAAW,KAAK,OAAO;AAAA,EACzB;AAAA,EACA,YAAY,CAAC,KAAK,MAAM,aAAa;AACnC,UAAM,YAAY;AAClB,UAAM,UAAU,UAAU,KAAK,YAAAC,QAAK,QAAQ,KAAK,YAAY,EAAE,YAAY,CAAC;AAC5E,UAAM,WAAW,UAAU,KAAK,KAAK,QAAQ;AAE7C,QAAI,WAAW,UAAU;AACvB,aAAO,SAAS,MAAM,IAAI;AAAA,IAC5B;AAEA,aAAS,IAAI,MAAM,OAAO,CAAC;AAAA,EAC7B;AACF,CAAC;AAEM,MAAM,oBAAoB,CAAC,SAAiB;AACjD,SAAO,CAAC,KAAc,KAAe,SAAuB;AAC1D,eAAW,OAAO,IAAI,EAAE,KAAK,KAAK,CAAC,QAAQ;AACzC,UAAI,eAAe,cAAAD,QAAO,aAAa;AACrC;AAAA,UACE,IAAI,8BAAgB;AAAA,YAClB,YAAY,qCAAY;AAAA,YACxB,SAAS,mCAAoB,OAAO,MAAM;AAAA,UAC5C,CAAC;AAAA,QACH;AAAA,MACF;AAEA,UAAI,eAAe,OAAO;AACxB;AAAA,UACE,IAAI,8BAAgB;AAAA,YAClB,YAAY,qCAAY;AAAA,YACxB,SAAS,mCAAoB,OAAO,MAAM;AAAA,UAC5C,CAAC;AAAA,QACH;AAAA,MACF;AAEA,WAAK;AAAA,IACP,CAAC;AAAA,EACH;AACF;",
  "names": ["multer", "path"]
}
