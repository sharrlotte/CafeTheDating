{
  "version": 3,
  "sources": ["../../../../src/middlewares/users.middlewares.ts"],
  "sourcesContent": ["import { VALIDATION_MESSAGES } from '@/constants/message'\r\nimport { checkSchema } from 'express-validator'\r\nimport validate from '@/utils/validate'\r\nimport { ErrorWithStatus } from '@/models/errors/Errors.schema'\r\nimport { StatusCodes } from 'http-status-codes'\r\nimport { databaseService } from '@/services/database.service'\r\nimport { JsonWebTokenError } from 'jsonwebtoken'\r\nimport { capitalize } from 'lodash'\r\n\r\nexport const refreshTokenValidator = validate(\r\n  checkSchema(\r\n    {\r\n      refresh_token: {\r\n        trim: true,\r\n        custom: {\r\n          options: async (value) => {\r\n            if (!value) {\r\n              throw new ErrorWithStatus({\r\n                statusCode: StatusCodes.UNAUTHORIZED,\r\n                message: VALIDATION_MESSAGES.USER.REFRESH_TOKEN.REFRESH_TOKEN_IS_REQUIRED\r\n              })\r\n            }\r\n\r\n            try {\r\n              const result = await databaseService.refreshTokens.findOne({ token: value })\r\n              if (!result) {\r\n                throw new ErrorWithStatus({\r\n                  message: VALIDATION_MESSAGES.USER.REFRESH_TOKEN.REFRESH_TOKEN_IS_NOT_EXIST,\r\n                  statusCode: StatusCodes.UNAUTHORIZED\r\n                })\r\n              }\r\n            } catch (error) {\r\n              if (error instanceof JsonWebTokenError) {\r\n                throw new ErrorWithStatus({\r\n                  message: capitalize(error.message),\r\n                  statusCode: StatusCodes.UNAUTHORIZED\r\n                })\r\n              }\r\n              throw error\r\n            }\r\n            return true\r\n          }\r\n        }\r\n      }\r\n    },\r\n    ['body']\r\n  )\r\n)\r\n\r\nexport const getAllUserValidator = validate(\r\n  checkSchema(\r\n    {\r\n      query: {\r\n        trim: true,\r\n        isString: {\r\n          errorMessage: VALIDATION_MESSAGES.USER.COMMONS.USERNAME_MUST_BE_STRING\r\n        }\r\n      }\r\n    },\r\n    ['query']\r\n  )\r\n)\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAoC;AACpC,+BAA4B;AAC5B,sBAAqB;AACrB,oBAAgC;AAChC,+BAA4B;AAC5B,sBAAgC;AAChC,0BAAkC;AAClC,oBAA2B;AAEpB,MAAM,4BAAwB,gBAAAA;AAAA,MACnC;AAAA,IACE;AAAA,MACE,eAAe;AAAA,QACb,MAAM;AAAA,QACN,QAAQ;AAAA,UACN,SAAS,OAAO,UAAU;AACxB,gBAAI,CAAC,OAAO;AACV,oBAAM,IAAI,8BAAgB;AAAA,gBACxB,YAAY,qCAAY;AAAA,gBACxB,SAAS,mCAAoB,KAAK,cAAc;AAAA,cAClD,CAAC;AAAA,YACH;AAEA,gBAAI;AACF,oBAAM,SAAS,MAAM,gCAAgB,cAAc,QAAQ,EAAE,OAAO,MAAM,CAAC;AAC3E,kBAAI,CAAC,QAAQ;AACX,sBAAM,IAAI,8BAAgB;AAAA,kBACxB,SAAS,mCAAoB,KAAK,cAAc;AAAA,kBAChD,YAAY,qCAAY;AAAA,gBAC1B,CAAC;AAAA,cACH;AAAA,YACF,SAAS,OAAP;AACA,kBAAI,iBAAiB,uCAAmB;AACtC,sBAAM,IAAI,8BAAgB;AAAA,kBACxB,aAAS,0BAAW,MAAM,OAAO;AAAA,kBACjC,YAAY,qCAAY;AAAA,gBAC1B,CAAC;AAAA,cACH;AACA,oBAAM;AAAA,YACR;AACA,mBAAO;AAAA,UACT;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,IACA,CAAC,MAAM;AAAA,EACT;AACF;AAEO,MAAM,0BAAsB,gBAAAA;AAAA,MACjC;AAAA,IACE;AAAA,MACE,OAAO;AAAA,QACL,MAAM;AAAA,QACN,UAAU;AAAA,UACR,cAAc,mCAAoB,KAAK,QAAQ;AAAA,QACjD;AAAA,MACF;AAAA,IACF;AAAA,IACA,CAAC,OAAO;AAAA,EACV;AACF;",
  "names": ["validate"]
}
