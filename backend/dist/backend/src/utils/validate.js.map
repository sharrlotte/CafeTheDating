{
  "version": 3,
  "sources": ["../../../../src/utils/validate.ts"],
  "sourcesContent": ["import { Request, Response, NextFunction } from 'express'\r\nimport { validationResult, ValidationChain } from 'express-validator'\r\nimport { RunnableValidationChains } from 'express-validator/src/middlewares/schema'\r\nimport { StatusCodes } from 'http-status-codes'\r\nimport { ErrorEnity, ErrorWithStatus } from '@/models/errors/Errors.schema'\r\n\r\nconst validate = (validations: RunnableValidationChains<ValidationChain>) => {\r\n  return async (req: Request, res: Response, next: NextFunction) => {\r\n    // Truy\u1EC1n req v\u00E0o \u0111\u1EC3 ti\u1EBFn h\u00E0nh validate d\u1EEF li\u1EC7u\r\n    await validations.run(req)\r\n    // \u0110\u01B0a l\u1ED7i v\u00E0o bi\u1EBFn req -> g\u1ECDi validation result \u0111\u1EC3 nh\u1EADn l\u1ED7i\r\n    const errors = validationResult(req)\r\n    // Kh\u00F4ng c\u00F3 l\u1ED7i th\u00EC next ti\u1EBFp t\u1EE5c request\r\n    if (errors.isEmpty ()) {\r\n      return next()\r\n    }\r\n    const errorObject = errors.mapped()\r\n    const entityError = new ErrorEnity({ errors: {} })\r\n    for (const key in errorObject) {\r\n      const { msg } = errorObject[key]\r\n      if (Object.prototype.hasOwnProperty.call(errorObject, key)) {\r\n        // msg c\u00F3 t\u1ED3n t\u1EA1i trong ErrorWithStatus v\u00E0 status ph\u1EA3i kh\u00E1c v\u1EDBi 422 t\u1EE9c l\u00E0 l\u1ED7i validation\r\n        if (msg instanceof ErrorWithStatus && msg.statusCode !== StatusCodes.UNPROCESSABLE_ENTITY) {\r\n          return next(msg)\r\n        }\r\n      }\r\n      entityError.errors[key] = errorObject[key]\r\n    }\r\n    // L\u1ED7i do validation th\u00F4ng th\u01B0\u1EDDng\r\n    next(entityError)\r\n  }\r\n}\r\n\r\nexport default validate\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,+BAAkD;AAElD,+BAA4B;AAC5B,oBAA4C;AAE5C,MAAM,WAAW,CAAC,gBAA2D;AAC3E,SAAO,OAAO,KAAc,KAAe,SAAuB;AAEhE,UAAM,YAAY,IAAI,GAAG;AAEzB,UAAM,aAAS,2CAAiB,GAAG;AAEnC,QAAI,OAAO,QAAS,GAAG;AACrB,aAAO,KAAK;AAAA,IACd;AACA,UAAM,cAAc,OAAO,OAAO;AAClC,UAAM,cAAc,IAAI,yBAAW,EAAE,QAAQ,CAAC,EAAE,CAAC;AACjD,eAAW,OAAO,aAAa;AAC7B,YAAM,EAAE,IAAI,IAAI,YAAY,GAAG;AAC/B,UAAI,OAAO,UAAU,eAAe,KAAK,aAAa,GAAG,GAAG;AAE1D,YAAI,eAAe,iCAAmB,IAAI,eAAe,qCAAY,sBAAsB;AACzF,iBAAO,KAAK,GAAG;AAAA,QACjB;AAAA,MACF;AACA,kBAAY,OAAO,GAAG,IAAI,YAAY,GAAG;AAAA,IAC3C;AAEA,SAAK,WAAW;AAAA,EAClB;AACF;AAEA,IAAO,mBAAQ;",
  "names": []
}
